<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fetch</title>
</head>
<body>
    <h1>Fetch, async/await and eventemitter</h1>

    <script>
        //Open on localhost 
        //Fetch is a requisition to something
        //It can receive a second parameter, a object, with the configuration
        //Default -> GET method

        fetch('data.json')
            .then(result => {
                if(result.status == 200)
                    return result.json()
                else 
                    throw new Error('Requesting error -> ' + result.status)
            })
            .then(result => {
                console.log("This is FETCH results: ", result)
            }).catch(error => {
                console.log('Handling error', error)
            })

        //Fetch -> Catch can handle a connection error (Status diff from 200)




        //Async / Await

        //Creating promises on a simple way
        //async create a promise automatically

        const asyncTimer = () => new Promise((resolve, reject) => {
            setTimeout(() => {
                resolve('Testing')
            }, 1000)
        })

        const aFunc = async() => {
            const data = await asyncTimer()
            console.log(data)
            const dataJSON = await fetch('data.json').then(result => result.json())

            return dataJSON;
        }

        aFunc()
        .then(result => console.log(result))
        .catch(error => console.log(error))

        //Await can be only used inside async
        //The await keyword make async functions on a sequence way

    </script>
</body>
</html>